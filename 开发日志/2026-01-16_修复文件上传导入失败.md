# 开发日志：修复文件上传导入失败问题

## 问题描述
用户报告文件上传导入功能失败，但粘贴导入功能正常工作。

## 原因分析
经过代码检查，发现问题出在控制器和视图之间的表单字段名不匹配：

1. 在`ShopCostsController.php`文件的`importPost`方法中，文件上传部分使用了`$_FILES['csv_file']`来获取上传的文件：
   ```php
   if (isset($_FILES['csv_file']) && $_FILES['csv_file']['error'] === UPLOAD_ERR_OK) {
       $file = $_FILES['csv_file'];
   ```

2. 但在`import.php`视图文件中，文件上传表单的input元素name属性是`excel_file`而不是`csv_file`：
   ```html
   <input type="file" class="form-control" id="excel_file" name="excel_file"
          accept=".csv,.txt" required>
   ```

这种不匹配导致文件上传时控制器无法正确获取到上传的文件，从而导致导入失败。

## 修复内容
将`ShopCostsController.php`文件中`importPost`方法的表单字段名从`'csv_file'`改为`'excel_file'`：

```php
// 处理文件上传
if (isset($_FILES['excel_file']) && $_FILES['excel_file']['error'] === UPLOAD_ERR_OK) {
    $file = $_FILES['excel_file'];
```

## 验证
修复后，文件上传导入功能应该能够正常工作：
1. 点击"选择文件"按钮，选择CSV文件
2. 点击"开始导入"按钮
3. 系统能够正确读取上传的CSV文件
4. 系统能够验证数据的有效性
5. 系统能够成功插入有效的新记录

## 注意事项
确保表单字段名在视图和控制器之间保持一致，避免类似的不匹配问题。

修复时间：2026-01-16 10:00:00
修复人员：开发人员
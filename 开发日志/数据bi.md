# 基于现有数据结构的 Dashboard 设计方案
## 一、设计核心原则
1. **以数据为中心**：完全依托现有数据库表结构，所有可视化组件均对应明确数据来源，不冗余设计；
2. **角色适配优先**：基于「管理员/编辑/查看者」权限体系，提供差异化视图与操作权限；
3. **分层可视化**：遵循「概览→明细→下钻」逻辑，从核心指标到具体数据逐步深入；
4. **实用性导向**：聚焦业务高频需求（利润监控、库存预警、商品管理、店铺运营），避免过度设计。

## 二、整体布局设计（响应式）
### 1. 页面框架（PC 端为主，适配平板）
| 区域          | 功能描述                                                                 | 设计细节                                                                 |
|---------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| 顶部导航栏    | 系统名称、用户信息、角色标识、退出登录、帮助中心                           | 固定顶部，高度 60px；用户信息hover显示角色+权限摘要；支持全局搜索（SKU/订单号/店铺名） |
| 左侧侧边栏    | 模块切换、角色专属菜单                                                   | 可折叠（默认展开），宽度 220px；菜单项与 6 大核心模块一一对应，无权限模块自动隐藏 |
| 顶部筛选栏    | 全局筛选条件、数据刷新按钮                                               | 高度 50px；包含时间筛选（今日/昨日/近7天/近30天/自定义）、店铺筛选、品类筛选、刷新按钮（手动/自动刷新，默认5分钟） |
| 主内容区      | 可视化组件布局（概览卡片+图表+明细表格）                                 | 采用网格布局（12列），组件间间距 20px；支持组件拖拽自定义布局（仅管理员可用） |
| 底部状态栏    | 数据更新时间、当前在线人数、系统状态                                     | 高度 30px；显示格式：「数据最后更新：2024-XX-XX XX:XX | 在线：XX人 | 状态：正常」 |

### 2. 模块菜单映射（按角色显示）
| 角色       | 侧边栏菜单（模块）                                                                 |
|------------|-----------------------------------------------------------------------------------|
| 管理员     | 1. 核心经营概览 2. 商品管理 3. 库存管理 4. 订单利润分析 5. 店铺运营 6. 权限与合规 7. 系统设置 |
| 编辑       | 1. 核心经营概览（简化版） 2. 商品管理 3. 库存管理 4. 订单利润分析 5. 店铺运营       |
| 查看者     | 1. 核心经营概览（只读版） 2. 商品管理（仅查看） 3. 库存管理（仅查看） 4. 订单利润分析（仅查看） 5. 店铺运营（仅查看） |

## 三、核心组件设计（分模块落地）
### （一）核心经营概览（首页默认展示）
#### 1. 顶部指标卡区域（12列布局，4个一行）
| 组件名称       | 展示内容                                                                 | 样式设计                                                                 | 交互逻辑                     |
|----------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|------------------------------|
| 总毛利润       | 数值（$XXX,XXX.XX）、日环比（+XX%/-XX%）、月同比（+XX%/-XX%）             | 主色：#2E7D32（绿色）；卡片圆角 8px；字体加粗（数值 24px，环比/同比 14px） | 点击卡片跳转到「订单利润分析」模块 |
| 订单总额       | 数值（$XXX,XXX.XX）、今日新增（$XX,XXX.XX）、订单总数（XXX 单）           | 主色：#1976D2（蓝色）；卡片带轻微阴影                                     | 点击卡片跳转到订单明细        |
| 总库存价值     | 数值（$XXX,XXX.XX）、库存总量（XXX 件）、滞销库存占比（XX%）              | 主色：#F57C00（橙色）；滞销占比超 30% 标红                                 | 点击卡片跳转到「库存管理」模块 |
| 日均广告花费   | 数值（$XXX.XX）、周环比（+XX%/-XX%）、本月累计（$XX,XXX.XX）              | 主色：#7B1FA2（紫色）；超预算标红                                         | 点击卡片跳转到广告花费明细    |

#### 2. 趋势图区域（12列布局，2个一行）
| 组件名称               | 展示内容                                                                 | 图表类型       | 交互逻辑                     |
|------------------------|--------------------------------------------------------------------------|----------------|------------------------------|
| 利润趋势图             | 按日/周/月展示利润变化，对比成本（出库成本+运费）                         | 折线图（双轴） | hover显示具体数值；支持切换时间粒度 |
| 订单量与广告花费趋势   | 订单量（左轴）、广告花费（右轴）联动展示                                 | 折线图+柱状图  | 支持隐藏单条曲线             |

#### 3. 分布概览区域（12列布局，3个一行）
| 组件名称               | 展示内容                                                                 | 图表类型       | 交互逻辑                     |
|------------------------|--------------------------------------------------------------------------|----------------|------------------------------|
| 店铺利润占比           | Top5 店铺的利润占比                                                       | 环形图         | 点击扇区下钻到该店铺明细     |
| 品类利润分布           | 各商品品类的利润贡献度                                                   | 饼图           | 点击扇区下钻到该品类明细     |
| 国家/地区订单分布      | 按收货国家统计订单量占比                                                 | 地图+饼图组合  | 地图hover显示订单量+利润     |

### （二）商品管理模块
#### 1. 核心组件布局（12列）
| 组件位置       | 组件名称               | 展示内容                                                                 | 图表/组件类型 | 交互逻辑                     |
|----------------|------------------------|--------------------------------------------------------------------------|---------------|------------------------------|
| 上半区（6+6列） | 商品状态分布           | 在售/停售/开发中/清仓商品数量及占比                                       | 柱状图+百分比标签 | 点击柱子下钻到对应状态商品列表 |
| 上半区（6+6列） | 新品创建趋势           | 按周/月统计新品创建数量                                                   | 折线图         | 支持切换时间粒度             |
| 下半区（8+4列） | 库存价值Top10商品      | SKU、商品名称、品类、库存总量、库存价值、库龄                             | 表格           | 支持排序、搜索；点击SKU跳转到商品详情 |
| 下半区（8+4列） | 无库存商品预警         | SKU、商品名称、品类、上次入库时间                                         | 预警卡片（红色边框） | 支持导出明细                 |

#### 2. 关键设计细节
- 表格支持「导出Excel」按钮（仅管理员/编辑可见）；
- 新品趋势图关联`new_products.create_time`，支持按「开发人员」筛选；
- 无库存商品预警组件自动刷新，超7天无库存标红提醒。

### （三）库存管理模块
#### 1. 核心组件布局（12列）
| 组件位置       | 组件名称               | 展示内容                                                                 | 图表/组件类型 | 交互逻辑                     |
|----------------|------------------------|--------------------------------------------------------------------------|---------------|------------------------------|
| 上半区（4+4+4列） | 库存总量概览           | 总库存、可用库存、在途库存、锁定库存                                     | 指标卡组合     | hover显示计算公式             |
| 上半区（4+4+4列） | 库龄分布               | 0-30天、31-90天、91天以上库龄库存数量及占比                               | 环形图         | 点击扇区下钻到对应库龄商品列表 |
| 中间区（12列）  | 仓库库存分布           | 各仓库库存总量、库存价值、可用库存                                       | 表格+进度条    | 支持按国家/仓库类型筛选；点击仓库名跳转到仓库明细 |
| 下半区（6+6列） | FBA库存健康度          | FBA可售/不可售/在途库存占比；库存健康度评分（1-10分）                     | 雷达图+评分卡  | 点击雷达图扇区查看明细       |
| 下半区（6+6列） | 库存预警看板           | 低于安全线商品、超90天滞销商品、库存成本异常商品                           | 标签页+列表    | 支持批量导出预警明细         |

#### 2. 关键设计细节
- 仓库库存表格关联`warehouses.country_code`，支持按国家筛选（如US/DE/CN）；
- FBA库存健康度评分基于「可售占比、库龄分布、滞销率」加权计算；
- 安全库存阈值可在「系统设置」中配置（仅管理员可见）。

### （四）订单利润分析模块
#### 1. 核心组件布局（12列）
| 组件位置       | 组件名称               | 展示内容                                                                 | 图表/组件类型 | 交互逻辑                     |
|----------------|------------------------|--------------------------------------------------------------------------|---------------|------------------------------|
| 上半区（6+6列） | 利润率趋势             | 按日/周/月展示平均利润率变化                                             | 折线图         | 支持切换「店铺/品类」维度     |
| 上半区（6+6列） | 成本结构分析           | 出库成本、运费成本、广告成本占订单总额的比例                               | 堆叠柱状图     | hover显示具体数值             |
| 中间区（12列）  | 店铺利润排名           | 店铺名称、平台、订单量、总利润、平均利润率                               | 表格+条形图    | 支持排序、筛选；点击店铺名下钻到店铺利润明细 |
| 下半区（12列）  | 利润明细查询           | 订单号、SKU、店铺、收货国家、下单时间、订单总额、成本、利润、利润率       | 高级表格       | 支持多条件筛选（时间、国家、SKU）、导出 |

#### 2. 关键设计细节
- 利润明细表格支持「利润率正负筛选」（正利润/负利润）；
- 成本结构分析关联`order_profit`和`costs`表，自动计算广告成本占比；
- 支持按「SKU」搜索具体商品的利润表现，展示该SKU在各店铺/国家的利润分布。

### （五）店铺运营模块
#### 1. 核心组件布局（12列）
| 组件位置       | 组件名称               | 展示内容                                                                 | 图表/组件类型 | 交互逻辑                     |
|----------------|------------------------|--------------------------------------------------------------------------|---------------|------------------------------|
| 上半区（4+4+4列） | 店铺概况指标           | 活跃店铺数、各平台店铺数、异常店铺数                                     | 指标卡组合     | 点击异常店铺数跳转到异常列表 |
| 上半区（4+4+4列） | 平台业绩分布           | 各平台（Amazon/eBay/Shopify）的订单量、利润占比                           | 饼图组合       | 点击扇区下钻到平台明细       |
| 中间区（12列）  | 店铺综合表现雷达图     | Top3 店铺的订单量、利润、广告花费、利润率、复购率（需补充复购表）         | 雷达图         | 支持切换店铺对比             |
| 下半区（6+6列） | 店铺广告ROI分析        | 店铺名称、广告花费、利润、ROI（利润/广告花费）                             | 表格+散点图    | ROI低于1标红；支持筛选       |
| 下半区（6+6列） | 店铺状态监控           | 店铺名称、状态、同步状态、最后订单时间、异常原因                           | 监控卡片       | 状态异常标红；支持快速编辑（仅管理员/编辑可见） |

#### 2. 关键设计细节
- 店铺综合表现雷达图支持自定义对比维度（如添加「库存健康度」「新品占比」）；
- 广告ROI自动计算：ROI=店铺总利润/店铺总广告花费；
- 异常店铺判定规则：状态≠1、30天无订单、利润率连续7天为负。

### （六）权限与合规模块（仅管理员可见）
#### 1. 核心组件布局（12列）
| 组件位置       | 组件名称               | 展示内容                                                                 | 图表/组件类型 | 交互逻辑                     |
|----------------|------------------------|--------------------------------------------------------------------------|---------------|------------------------------|
| 上半区（6+6列） | 用户角色分布           | 各角色（管理员/编辑/查看者）的用户数量及占比                               | 饼图+表格     | 点击角色查看用户列表         |
| 上半区（6+6列） | 权限分配统计           | 各角色已分配权限数、未分配权限数                                         | 柱状图         | 支持切换角色查看             |
| 中间区（12列）  | 用户管理表格           | 用户名、邮箱、姓名、角色、状态、创建时间、最后登录时间                     | 表格           | 支持编辑角色、启用/禁用用户、重置密码 |
| 下半区（12列）  | 角色权限配置           | 角色名称、权限列表（按模块分组）                                           | 树形表格       | 支持勾选分配权限、批量保存   |

#### 2. 关键设计细节
- 角色权限配置表格支持「全选/反选」，分配后实时同步到`role_permissions`表；
- 用户管理表格支持「批量导入用户」「导出用户列表」；
- 记录权限变更日志（如「管理员XX于2024-XX-XX为用户XX分配编辑角色」）。

## 四、角色专属视图差异
| 功能/组件               | 管理员视图                     | 编辑视图                     | 查看者视图                     |
|-------------------------|--------------------------------|--------------------------------|--------------------------------|
| 模块可见性              | 全部6大模块+系统设置           | 5大业务模块（无权限合规+系统设置简化） | 5大业务模块（仅查看权限）       |
| 操作按钮（导出/编辑）   | 所有模块支持导出、编辑、配置    | 业务模块支持导出，无权限配置    | 无任何编辑/导出/配置按钮        |
| 数据可见性              | 全量数据（含成本、广告花费明细） | 授权业务数据（不含权限/用户数据） | 仅查看类数据（无成本/广告明细） |
| 预警配置                | 可配置预警规则、阈值、推送方式  | 仅查看预警，无配置权限          | 仅查看预警，无配置权限          |
| 自定义布局              | 支持拖拽调整组件位置、隐藏组件  | 不支持自定义布局                | 不支持自定义布局                |

## 五、视觉设计规范
### 1. 配色方案
- 主色：#1E88E5（蓝色，用于标题、按钮、核心指标）；
- 辅助色：
  - 成功色：#2E7D32（绿色，用于正利润、正常状态）；
  - 警告色：#F57C00（橙色，用于滞销、低库存）；
  - 危险色：#D32F2F（红色，用于负利润、异常状态）；
  - 中性色：#F5F7FA（背景）、#424242（文本）、#9E9E9E（辅助文本）；
- 图表配色：同一维度图表使用渐变色系，避免颜色冲突（如店铺分布用蓝→青→紫渐变）。

### 2. 字体规范
- 标题：16-18px，加粗（font-weight: 600）；
- 指标数值：20-24px，加粗；
- 图表标签/表格文本：14px，常规；
- 辅助文本（备注、时间）：12px，浅色（#9E9E9E）；
- 字体家族：思源黑体（Noto Sans SC），兼容中英文显示。

### 3. 组件样式规范
- 卡片：圆角 8px，轻微阴影（box-shadow: 0 2px 8px rgba(0,0,0,0.08)），内边距 16px；
- 表格：表头背景色 #F5F7FA，行高 40px，hover 行背景色 #F9FAFB，边框 1px solid #E0E0E0；
- 按钮：圆角 4px，主按钮背景色 #1E88E5，hover 加深 10%，文字白色；
- 图表：无坐标轴边框，网格线为虚线（#E0E0E0），图例位置统一在底部。

## 六、交互设计规范
### 1. 通用交互
- 筛选器联动：顶部时间/店铺/品类筛选器作用于当前模块所有组件，筛选后实时刷新；
- hover效果：指标卡、图表扇区/柱子、表格行hover时显示详细信息（如数值、说明）；
- 加载状态：组件加载时显示骨架屏，避免空白等待；
- 错误处理：数据加载失败时显示重试按钮，点击重新请求数据。

### 2. 下钻与跳转逻辑
- 概览→明细：点击指标卡/图表→跳转到对应模块的明细页面；
- 明细→详情：点击表格中的SKU/店铺名/订单号→弹出详情弹窗（显示完整信息）；
- 跨模块跳转：支持从「商品管理」点击SKU→跳转到「订单利润分析」的SKU利润明细。

### 3. 预警交互
- 预警提示：大盘首页顶部显示预警数量（如「3条库存预警 | 2条店铺异常」）；
- 跳转逻辑：点击预警提示→跳转到对应模块的预警看板；
- 推送方式：支持系统消息、邮件推送（管理员可在系统设置中配置）。

## 七、技术落地要点
### 1. 数据层
- 数据预处理：
  - 转换`order_profit`中带$的金额字段为数值类型（如`profit_amount`替换$后转DECIMAL）；
  - 解析JSON字段（如`inventory_details.third_inventory`提取可售数量），存储到中间表；
  - 定时任务（每小时）预计算核心指标（总利润、库存总量、平均利润率），提升查询速度；
- 索引优化：为`order_profit`新增`idx_store_id`（店铺ID）、`idx_purchase_time`（下单时间）索引；为`costs`新增`idx_store_date`（店铺+日期）索引。

### 2. 前端层
- 技术选型：Vue3 + Element Plus（组件库）+ ECharts（可视化）+ Axios（请求）；
- 响应式适配：支持1920×1080（主流）、1366×768（兼容）分辨率，组件自动换行/缩放；
- 性能优化：组件懒加载、大数据表格虚拟滚动（明细表格超过1000行时启用）、图表数据分页加载。

### 3. 权限层
- 基于`role_permissions`表动态渲染菜单和组件：无权限的模块不显示，无操作权限的按钮（如导出、编辑）隐藏；
- 接口权限控制：后端接口校验用户角色，仅返回该角色有权访问的数据（如查看者无法获取成本明细）。

## 八、落地步骤
1. **第一阶段（1-2周）**：完成核心经营概览、订单利润分析模块，实现核心指标可视化和基础筛选；
2. **第二阶段（2-3周）**：完成商品管理、库存管理、店铺运营模块，实现下钻、预警功能；
3. **第三阶段（1-2周）**：完成权限与合规模块、系统设置，适配角色权限，优化交互体验；
4. **第四阶段（1周）**：测试（性能测试、权限测试、兼容性测试）、bug修复、上线部署。

## 九、总结
本 Dashboard 设计方案完全基于现有数据结构，聚焦业务核心需求，通过「分层可视化+角色适配+高效交互」实现数据驱动决策。核心优势：
1. 与现有权限体系完全兼容，无需额外调整数据结构；
2. 组件化设计，支持快速迭代（可根据业务需求新增模块）；
3. 注重实用性，所有可视化均服务于实际业务场景（如库存预警、利润分析、店铺监控）；
4. 技术落地难度低，依托成熟的前端组件库和数据预处理方案，可快速上线。
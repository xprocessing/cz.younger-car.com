# 修复赛道统计模块数据不一致问题

## 任务描述
修复赛道统计模块中的总订单金额与平台销售额统计数据不一致的问题，确保两者数据保持一致。

## 问题分析
- **根本原因**：赛道统计模块使用了内连接（JOIN）查询，而平台销售额统计使用了左连接（LEFT JOIN）查询
- **影响**：内连接会过滤掉那些在store表中没有对应记录的订单，导致赛道统计中的总订单金额比平台销售额小很多
- **其他问题**：赛道统计模块的数据转换逻辑与平台销售额统计不一致，没有处理可能存在的百分号(%)字符

## 完成的工作

### 1. 修改TrackStatistics模型
- **文件路径**: `admin-panel/models/TrackStatistics.php`
- **修改内容**:
  - 将内连接（JOIN）改为左连接（LEFT JOIN），确保包含所有订单数据
  - 调整表的顺序，将order_profit作为主表，store作为从表
  - 更新日期过滤条件，使用DATE()函数确保与平台销售额统计一致
  - 增强数据转换逻辑，添加对百分号(%)字符的处理

### 2. 技术细节
- **连接类型**：从内连接（JOIN）改为左连接（LEFT JOIN）
- **表顺序**：order_profit作为主表，store作为从表
- **日期过滤**：使用`DATE(op.global_purchase_time) BETWEEN ? AND ?`确保与平台销售额统计一致
- **数据转换**：使用`REPLACE(REPLACE(REPLACE(op.order_total_amount, '$', ''), ',', ''), '%', '')`处理可能存在的百分号字符

### 3. 验证更新
- 使用 `php -l` 命令检查修改后的文件
- 确认没有语法错误

## 结论
已成功修复赛道统计模块中总订单金额与平台销售额不一致的问题。通过将内连接改为左连接，并确保日期过滤和数据转换逻辑与平台销售额统计一致，现在两者的数据应该能够保持一致，确保了统计结果的准确性。
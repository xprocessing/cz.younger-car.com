# 2026-01-19 添加公司运营费用模块统计功能

## 更新内容

### 1. 模型层更新（models/CompanyCosts.php）
- 添加了`getMonthlyStatistics()`方法：获取过去12个月的费用总额统计
- 添加了`getCurrentMonthStatistics()`方法：获取本月各类型费用统计
- 添加了`getPreviousMonthStatistics()`方法：获取上月各类型费用统计

### 2. 控制器层更新（controllers/CompanyCostsController.php）
- 在`index()`方法中调用三个统计方法
- 将统计数据传递给视图层

### 3. 视图层更新（views/company_costs/index.php）
- 添加了月度统计图表（折线图）
- 添加了本月费用统计图表（饼图）
- 添加了上月费用统计图表（饼图）
- 使用Chart.js绘制图表，支持鼠标悬停查看具体数值
- 修复了可能的除零错误

## 技术细节

### 1. 月度统计（过去12个月）
- 显示过去12个月的费用总额变化趋势
- 使用折线图展示
- 确保返回12个月的数据，包括没有数据的月份

### 2. 本月费用统计
- 统计本月各类型费用的分布情况
- 使用饼图展示，显示各类型费用占比
- 自动计算并显示本月总费用

### 3. 上月费用统计
- 统计上月各类型费用的分布情况
- 使用饼图展示，便于与本月数据对比分析
- 自动计算并显示上月总费用

## 技术栈

- **后端**：PHP + MySQL
- **前端**：Chart.js（图表绘制）、Bootstrap（页面布局）、JavaScript

## 优化点

- 修复了可能的除零错误
- 确保代码兼容性和稳定性
- 优化了用户体验，提供直观的数据可视化
- 响应式设计，适配不同屏幕尺寸
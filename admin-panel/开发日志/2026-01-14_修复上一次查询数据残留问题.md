# 修复上一次查询数据残留问题

## 1. 问题描述
当用户使用批量查询功能后，刷新页面或导航后返回时，页面仍然显示上一次批量查询的结果，而不是默认的所有库存预警数据。

## 2. 问题原因
在控制器的处理逻辑中，当用户发送GET请求时，系统会检查会话中是否有批量查询的SKU列表，如果有则继续使用该列表进行查询。这导致用户在批量查询后，即使不提交新的查询表单，仍然会看到上一次的查询结果。

## 3. 修复内容

### 3.1 控制器层更新

#### InventoryDetailsController.php
1. **更新 `inventoryAlert` 方法**
   - 修改GET请求分支的处理逻辑，不再检查会话中的批量查询条件
   - 在GET请求时，直接查询所有库存预警数据
   - 清除会话中的批量查询数据，确保用户刷新页面或导航后返回时看到的是所有数据

## 4. 修复逻辑

```php
} else {
    // 在GET请求时，默认查询所有数据，不使用会话中的批量查询条件
    // 这样可以确保用户刷新页面或导航后返回时看到的是所有数据
    $totalCount = 0;
    $inventoryAlerts = $this->inventoryDetailsModel->getInventoryAlert($limit, $offset, $totalCount);
    // 清除会话中的批量查询数据
    unset($_SESSION['batch_sku_list']);
}
```

## 5. 修复效果

1. 当用户使用批量查询功能时，系统仍然会正常显示批量查询的结果
2. 当用户刷新页面或导航后返回时，系统会清除上一次的批量查询条件，显示所有库存预警数据
3. 解决了批量查询数据残留的问题，提高了用户体验

## 6. 文件变更列表

- `controllers/InventoryDetailsController.php`: 修复GET请求时的查询逻辑
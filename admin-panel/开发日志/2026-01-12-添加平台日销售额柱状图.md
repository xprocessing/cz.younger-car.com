# 2026-01-12 添加平台日销售额柱状图

## 更新内容

在dashboard.php中添加了三个新的柱状图，分别显示Amazon + Amazon-FBA、eBay和Shopify平台近60天的日销售额数据。

## 修改文件

- `admin-panel/views/dashboard.php`

## 具体修改

1. **添加三个新的canvas元素**：
```html
<!-- Amazon + Amazon-FBA 平台近60天日销售额柱状图 -->
<div class="row">
    <div class="col-md-12">
        <div class="mb-12">
            <h3>Amazon + Amazon-FBA 平台近60天日销售额柱状图</h3>
            <canvas id="amazonSalesChart" height="300" style="width: 100%;"></canvas>
        </div>
    </div>
</div>

<!-- eBay 平台近60天日销售额柱状图 -->
<div class="row">
    <div class="col-md-12">
        <div class="mb-12">
            <h3>eBay 平台近60天日销售额柱状图</h3>
            <canvas id="ebaySalesChart" height="300" style="width: 100%;"></canvas>
        </div>
    </div>
</div>

<!-- Shopify 平台近60天日销售额柱状图 -->
<div class="row">
    <div class="col-md-12">
        <div class="mb-12">
            <h3>Shopify 平台近60天日销售额柱状图</h3>
            <canvas id="shopifySalesChart" height="300" style="width: 100%;"></canvas>
        </div>
    </div>
</div>
```

2. **添加柱状图绘制函数**：
```javascript
function drawBarChart(canvasId, data, platformsToShow, chartTitle) {
    // 动态设置canvas宽度
    canvas.width = canvas.clientWidth;
    
    // 绘制背景、网格线、坐标轴
    // 准备要显示的数据
    // 计算Y轴刻度和柱状图宽度
    // 绘制柱状图
    // 显示数值标签
    // 绘制图表标题
}
```

3. **更新图表绘制函数调用**：
```javascript
function drawAllCharts() {
    // 原有的图表绘制调用
    
    // 新增柱状图绘制调用
    drawBarChart('amazonSalesChart', dailySalesData, ['Amazon', 'Amazon-FBA'], 'Amazon + Amazon-FBA 平台近60天日销售额');
    drawBarChart('ebaySalesChart', dailySalesData, ['eBay'], 'eBay 平台近60天日销售额');
    drawBarChart('shopifySalesChart', dailySalesData, ['Shopify'], 'Shopify 平台近60天日销售额');
}
```

## 效果

- 三个新的柱状图现在显示在折线图下方，每个占满整行宽度
- 图表高度设置为300px，宽度自适应网页
- Amazon + Amazon-FBA柱状图显示这两个平台的日销售额总和
- eBay和Shopify柱状图分别显示各自平台的日销售额
- 柱状图包含坐标轴、网格线、数值标签和图表标题
- 与折线图保持一致的配色方案和设计风格

## 技术细节

- 使用现有的`getDailyPlatformSales`方法获取数据，无需修改模型
- 柱状图绘制函数支持过滤显示特定平台的数据
- 动态计算柱状图宽度，确保在不同数据量下都能合理显示
- 每5天显示一个数值标签，避免标签过于密集
- 使用蓝色作为柱状图主色调，保持与整体设计的一致性
- 支持响应式设计，在窗口大小变化时自动重新绘制